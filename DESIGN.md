# 作曲ツール 実装構想メモ

## 現在の構成

- `player.js` — スコアベースの再生エンジン（BPM・duration対応）
- `instruments.js` — 楽器定義（piano / drums / bass / aco_guitar）
- `index.html` — トラック別ステップシーケンサーUI

---

## 今後の実装アイデア

### 1. メロディトラックUI（オクターブタブ切替）

1オクターブ（12行）を常に表示し、タブで音域を切り替える。

```
🎹 Piano   [Oct 3 🔵] [Oct 4 🟢] [Oct 5 🟡]        [✕削除]
           1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16
C3  🔵     [■][ ][ ][ ][ ][ ][ ][ ][■][ ][ ][ ][ ][ ][ ][ ]
B2  🔵     [ ][ ][ ][ ][ ][ ][ ][ ][ ][ ][ ][ ][ ][ ][ ][ ]
A#2 🔵     ...
（計12行 = 1オクターブ分）
```

- タブで Oct 4 を選ぶと同じ行が緑に切り替わり、そのオクターブのステップを編集できる
- 各オクターブのステップデータは独立して保持
- 再生時は全オクターブのオンステップをまとめてスコアに変換
- 黒鍵（C#, D# など）は行の色をやや暗くして視覚的に区別

**メリット**
- 画面が常に12行で一定、窮屈にならない
- 色でどのオクターブの音か一目でわかる
- 複数オクターブにまたがる和音・メロディも自然に作れる

---

### 2. 和音追加機能

コード名を選ぶと構成音を自動展開して同時再生。

- 例: Cmaj → C + E + G を同ステップにセット
- `player.js` の `notes` は配列対応済みなので、スコア構築側の変更のみで対応可能

---

### 3. スケール選択メロディ機能

スケールを選ぶとそのスケール内の音だけ表示（スケール外をグレーアウト）。

- 例: Cメジャースケール → C, D, E, F, G, A, B のみ有効
- 和音機能とも組み合わせやすい（スケール外の音を含むコードを無効化するなど）
