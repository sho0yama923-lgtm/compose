# 作曲ツール — Claude 向け開発指針

## プロジェクトの最終目標

**音楽初学者でもスマホで直感的に使える作曲ツール**

- 音楽理論を知らなくても触れる
- シンプルなUIで迷わない
- 「なんとなく押したら曲になった」という体験を目指す

---

## 設計の基本方針

### シンプルさを最優先する
- 機能を増やすより、今ある機能をわかりやすくすることを優先する
- 1画面に情報を詰め込みすぎない
- ボタンや操作は最小限に絞る

### スマホ前提で作る
- タッチ操作でストレスなく使えること
- ボタンは指で押しやすいサイズ（最低 44px）
- 横スクロールが必要な部分は `-webkit-overflow-scrolling: touch` を使う
- `touch-action: manipulation` でダブルタップズームを防ぐ

### 初学者に優しいガイドを意識する
- 空の状態（emptyState）にはわかりやすい誘導テキストを置く
- エラーや操作ミスが起きにくいUI設計を心がける
- 専門用語を使う場合は、できるだけ補足する

---

## ファイル構成

| ファイル | 役割 |
|---|---|
| `index.html` | UIのHTMLとCSSのみ。JSは書かない |
| `app.js` | 状態管理・描画・イベント処理 |
| `constants.js` | 定数（楽器定義・音名・色設定など） |
| `player.js` | Tone.jsを使った再生エンジン |
| `instruments.js` | 楽器ごとのサンプラー定義 |

### ルール
- `index.html` にインラインスクリプトは書かない
- 定数は `constants.js` に集める
- 機能が増えてきたら積極的にファイルを分割する

---

## 技術スタック

- **Tone.js v14.8.49** — 音声再生（CDN）
- **ES Modules** — `type="module"` でファイル分割
- **ローカルサーバー** — `python3 -m http.server 8080`（ES Modules + 音声のCORSに必要）

---

## データモデル

### ステップシーケンサー（16ステップ = 1小節）

```js
// ドラムトラック
{ id, instrument: 'drums', rows: [{ label, note, steps: Array(16) }] }

// メロディトラック（ピアノ・ベース・ギター）
{ id, instrument: 'piano', activeOctave: 4, stepsMap: { 'C4': Array(16), ... } }
```

### スコア（再生時に構築）

```js
score[i] = [{ instrument: 'piano', notes: 'C4' }]  // null = 無音
```

---

## UIのトーン・デザイン

- 背景: ダーク系（`#1a1a2e`）
- アクセント: 青系（`#42a5f5`）
- オクターブごとに色分け（低音=青、中音=緑、高音=黄〜橙）
- 余白を十分に取り、窮屈にならないようにする

---

## やらないこと（スコープ外）

- 複雑な音楽理論機能（MIDIエクスポート、マルチトラックミキサーなど）
- PC専用レイアウト
- ユーザー登録・データ保存（将来的には検討）
